/*

Test gaussian without calculating the initial guess

*/


var LM = require('ml-levenberg-marquardt');
var d3 = require('d3');

function gaussian(A, center, fwhm) {
  return (x) =>
             (A * Math.exp(-4 * Math.log(2) * (x - center)**2 / fwhm**2));
}

// this date is an ideal gaussian
var data = {
  x : [
    0.,          0.18644068,  0.37288136,  0.55932203,  0.74576271,  0.93220339,
    1.11864407,  1.30508475,  1.49152542,  1.6779661,   1.86440678,  2.05084746,
    2.23728814,  2.42372881,  2.61016949,  2.79661017,  2.98305085,  3.16949153,
    3.3559322,   3.54237288,  3.72881356,  3.91525424,  4.10169492,  4.28813559,
    4.47457627,  4.66101695,  4.84745763,  5.03389831,  5.22033898,  5.40677966,
    5.59322034,  5.77966102,  5.96610169,  6.15254237,  6.33898305,  6.52542373,
    6.71186441,  6.89830508,  7.08474576,  7.27118644,  7.45762712,  7.6440678,
    7.83050847,  8.01694915,  8.20338983,  8.38983051,  8.57627119,  8.76271186,
    8.94915254,  9.13559322,  9.3220339,   9.50847458,  9.69491525,  9.88135593,
    10.06779661, 10.25423729, 10.44067797, 10.62711864, 10.81355932, 11.
  ],
  y : [
    3.12500000e-01, 5.11544155e-01, 7.97973650e-01, 1.18622287e+00,
    1.68041424e+00, 2.26849974e+00, 2.91832350e+00, 3.57767140e+00,
    4.17964873e+00, 4.65319699e+00, 4.93668493e+00, 4.99104749e+00,
    4.80861838e+00, 4.41490376e+00, 3.86273120e+00, 3.22062421e+00,
    2.55892724e+00, 1.93752868e+00, 1.39801123e+00, 9.61270250e-01,
    6.29872518e-01, 3.93307418e-01, 2.34036682e-01, 1.32711344e-01,
    7.17140882e-02, 3.69294834e-02, 1.81223412e-02, 8.47476553e-03,
    3.77670792e-03, 1.60387835e-03, 6.49085294e-04, 2.50325120e-04,
    9.19982179e-05, 3.22200875e-05, 1.07534132e-05, 3.42009580e-06,
    1.03657929e-06, 2.99391250e-07, 8.24039436e-08, 2.16137044e-08,
    5.40235027e-09, 1.28679270e-09, 2.92083320e-10, 6.31796539e-11,
    1.30232701e-11, 2.55820399e-12, 4.78875495e-13, 8.54244860e-14,
    1.45215995e-14, 2.35244161e-15, 3.63157961e-16, 5.34250090e-17,
    7.48972648e-18, 1.00059800e-18, 1.27387150e-19, 1.54548193e-20,
    1.78679430e-21, 1.96860011e-22, 2.06686814e-23, 2.06795153e-24
  ]
};

const options = {
  damping : 0.001,
  initialValues : [ 5.7, 1.5, 2.3 ] // Ideal: [5, 2, 2]
};

var ans = LM(data, gaussian, options);
console.log(ans);

