/*

Test lorentzian without calculating the initial guess

*/

var LM = require('ml-levenberg-marquardt');
var d3 = require('d3');

function lorentzian(A, center, fwhm) {
  return (x) => (A * ((fwhm / 2) / ((x - center)**2 + (fwhm / 2)**2)));
}

// this is noisy data for a lorentzian
var data = {
  x : [
    0.,         0.20408163, 0.40816327, 0.6122449,  0.81632653, 1.02040816,
    1.2244898,  1.42857143, 1.63265306, 1.83673469, 2.04081633, 2.24489796,
    2.44897959, 2.65306122, 2.85714286, 3.06122449, 3.26530612, 3.46938776,
    3.67346939, 3.87755102, 4.08163265, 4.28571429, 4.48979592, 4.69387755,
    4.89795918, 5.10204082, 5.30612245, 5.51020408, 5.71428571, 5.91836735,
    6.12244898, 6.32653061, 6.53061224, 6.73469388, 6.93877551, 7.14285714,
    7.34693878, 7.55102041, 7.75510204, 7.95918367, 8.16326531, 8.36734694,
    8.57142857, 8.7755102,  8.97959184, 9.18367347, 9.3877551,  9.59183673,
    9.79591837, 10.
  ],
  y : [
    0.39905685, 0.58150864, 0.65044372, 0.46164016, 0.7536742,  0.61815869,
    0.56501322, 0.52400696, 0.62321446, 0.54187972, 0.89383905, 0.76757875,
    1.04637856, 0.84842346, 0.97196309, 1.13921458, 1.16123379, 1.09222526,
    1.30506616, 1.61624551, 1.68760691, 1.9617899,  1.92329728, 2.17662082,
    2.24699558, 2.04291121, 2.13581526, 2.09322716, 1.85982329, 1.68136641,
    1.30242442, 1.35405576, 1.14813912, 1.20214406, 1.27039522, 1.01265884,
    1.07935763, 0.9236002,  0.9092215,  0.74516143, 0.95528996, 0.50757227,
    0.55670779, 0.60529763, 0.76655114, 0.78577269, 0.36864172, 0.18931469,
    0.29676961, 0.5863918
  ]
};

const options = {
  damping : 0.001,
  initialValues : [ 5.7, 5.1, 2.3 ] // Ideal: A=5.00 center=5.00 fwhm=2.00
};

var ans = LM(data, lorentzian, options);
console.log("Expecting: A=5.00 center=5.00 fwhm=2.00");
console.log(ans);
